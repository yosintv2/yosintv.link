<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title> streamtp11 Match List </title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans min-h-screen">
  <div class="container mx-auto p-6">
    <h1 class="text-3xl font-bold text-center mb-4 text-gray-800">Today's Events</h1>

    <!-- Search -->
    <div class="mb-6">
      <input 
        type="text" 
        id="search" 
        placeholder="Search events..." 
        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring focus:border-blue-300"
      />
    </div>

    <!-- Loading / Error -->
    <div id="loading" class="text-center text-gray-500">Loading events...</div>
    <div id="error" class="text-center text-red-500 hidden"></div>

    <!-- Events -->
    <div id="events" class="space-y-4 hidden"></div>
  </div>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-5 right-5 bg-green-600 text-white px-4 py-2 rounded shadow hidden">
    Copied!
  </div>

  <script>
    let allEvents = [];

    async function fetchEvents() {
      const loading = document.getElementById("loading");
      const error = document.getElementById("error");
      const eventsDiv = document.getElementById("events");

      try {
        const res = await fetch("https://corsproxy.io/?url=https://streamtpglobal.com/eventos.json");
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const data = await res.json();

        // Group matches by title+time+category+status
        const grouped = {};
        data.forEach(ev => {
          const key = ev.title + "|" + ev.time + "|" + ev.category + "|" + ev.status;
          if (!grouped[key]) {
            grouped[key] = { ...ev, links: [] };
          }
          grouped[key].links.push(ev.link);
        });

        allEvents = Object.values(grouped);

        renderEvents(allEvents);
        loading.classList.add("hidden");
        eventsDiv.classList.remove("hidden");

      } catch (err) {
        console.error(err);
        loading.classList.add("hidden");
        error.textContent = "Error: " + err.message;
        error.classList.remove("hidden");
      }
    }

    function renderEvents(events) {
      const container = document.getElementById("events");
      container.innerHTML = "";

      events.forEach(ev => {
        const card = document.createElement("div");
        card.className = "bg-white p-4 rounded-lg shadow flex flex-col space-y-2";

        const titleRow = document.createElement("div");
        titleRow.className = "flex justify-between items-center";

        const title = document.createElement("h2");
        title.className = "text-lg font-semibold text-gray-800";
        title.textContent = ev.title;

        const copyNameBtn = document.createElement("button");
        copyNameBtn.className = "bg-gray-200 hover:bg-gray-300 text-gray-700 px-2 py-1 rounded text-xs ml-3";
        copyNameBtn.textContent = "Copy Name";
        copyNameBtn.onclick = () => copyToClipboard(ev.title);

        titleRow.appendChild(title);
        titleRow.appendChild(copyNameBtn);

        const time = document.createElement("div");
        time.className = "text-sm text-gray-600";
        time.textContent = "⏰ " + ev.time;

        const status = document.createElement("div");
        status.className = "text-sm font-medium " + 
          (ev.status?.toLowerCase().includes("vivo") 
            ? "text-red-500" 
            : ev.status?.toLowerCase().includes("pronto") 
              ? "text-yellow-600"
              : "text-blue-500");
        status.textContent = "📺 " + ev.status;

        const bottomRow = document.createElement("div");
        bottomRow.className = "flex flex-wrap justify-between items-center gap-2";

        const linksDiv = document.createElement("div");
        linksDiv.className = "flex flex-wrap gap-2";

        ev.links.forEach((url, i) => {
          const btn = document.createElement("button");
          btn.className = "bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm";
          btn.textContent = "Link " + (i + 1);
          btn.onclick = () => copyToClipboard(url);
          linksDiv.appendChild(btn);
        });

        const category = document.createElement("div");
        category.className = "italic text-gray-500 text-sm ml-auto";
        category.textContent = ev.category;

        bottomRow.appendChild(linksDiv);
        bottomRow.appendChild(category);

        card.appendChild(titleRow);
        card.appendChild(time);
        card.appendChild(status);
        card.appendChild(bottomRow);
        container.appendChild(card);
      });
    }

    function copyToClipboard(text) {
      navigator.clipboard.writeText(text).then(() => {
        const toast = document.getElementById("toast");
        toast.classList.remove("hidden");
        setTimeout(() => toast.classList.add("hidden"), 1500);
      });
    }

    // Search filter
    document.getElementById("search").addEventListener("input", (e) => {
      const q = e.target.value.toLowerCase();
      renderEvents(allEvents.filter(ev => 
        ev.title.toLowerCase().includes(q) || ev.category.toLowerCase().includes(q)
      ));
    });

    window.onload = fetchEvents;
  </script>
<div class="gtranslate_wrapper"></div>
  <script>
    window.gtranslateSettings = {"default_language":"en","native_language_names":true,"detect_browser_language":true,"wrapper_selector":".gtranslate_wrapper"}
  </script>

</body>
</html>
