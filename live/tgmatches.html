<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TG Match Generator Pro</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #f0f2f5;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      font-family: system-ui, -apple-system, sans-serif;
    }
    .container {
      max-width: 800px;
      background: #fff;
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    pre {
      background: #f8f9fa;
      padding: 1.5rem;
      border: 1px solid #dee2e6;
      border-radius: 0.75rem;
      cursor: pointer;
      font-size: 1.05rem;
      line-height: 1.7;
      font-family: "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", sans-serif;
      white-space: pre-wrap;
      word-wrap: break-word;
      transition: background 0.2s;
    }
    pre:hover { background: #e9ecef; }
    .preview-box {
      background: #e3f2fd;
      padding: 1.5rem;
      border-radius: 0.75rem;
      border: 1px solid #bbdefb;
      font-size: 1.1rem;
      font-weight: 500;
      color: #1565c0;
      cursor: pointer;
      white-space: pre-wrap;
      transition: background 0.2s;
    }
    .preview-box:hover { background: #bbdefb; }
    .copy-message {
      color: #28a745;
      font-weight: bold;
      font-size: 1.1rem;
      margin-top: 1rem;
      opacity: 0;
      animation: fadeInOut 3s ease forwards;
    }
    @keyframes fadeInOut {
      0% { opacity: 0; transform: translateY(10px); }
      15% { opacity: 1; transform: translateY(0); }
      85% { opacity: 1; }
      100% { opacity: 0; }
    }
    details { margin-bottom: 1.5rem; }
    summary { cursor: pointer; font-weight: bold; color: #0d6efd; }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="text-center mb-5 display-6 fw-bold text-primary">‚ö° TG Match Generator Pro</h1>

    <!-- Sport Mode -->
    <div class="mb-4">
      <label class="form-label fw-bold">Sport Mode:</label>
      <div class="row g-3">
        <div class="col-sm-4">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sport" id="football" value="football">
            <label class="form-check-label fw-medium" for="football">‚öΩ Football Only</label>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sport" id="cricket" value="cricket">
            <label class="form-check-label fw-medium" for="cricket">üèè Cricket Only</label>
          </div>
        </div>
        <div class="col-sm-4">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="sport" id="both" value="both">
            <label class="form-check-label fw-medium" for="both">üî• Both Sports</label>
          </div>
        </div>
      </div>
    </div>

    <!-- Custom Date -->
    <div class="mb-4">
      <label for="customDate" class="form-label fw-medium">Custom Date (optional):</label>
      <input type="text" id="customDate" class="form-control" placeholder="e.g., 17 December 2025">
      <small class="text-muted">Leave blank ‚Üí auto uses today's date</small>
    </div>

    <!-- Matchups Input -->
    <div class="mb-4">
      <label for="matchups" class="form-label fw-bold">Matchups (3 lines per match):</label>
      <textarea id="matchups" rows="12" class="form-control" placeholder="2:00
PSG vs Flamengo | FIFA Intercontinental Cup Final
psg
04:30
Arsenal vs Liverpool
arsenal
03:00
Atl√©tico Baleares vs Atl√©tico Madrid
atletico"></textarea>
      <small class="text-muted">Add | Competition Name after teams for üèÜ line (optional)</small>
    </div>

    <!-- Custom Links -->
    <details class="mb-4 bg-light p-3 rounded">
      <summary class="fw-bold text-primary">‚öôÔ∏è Customize Links (saved automatically)</summary>
      <div class="mt-3 row g-3">
        <div class="col-md-6">
          <label class="form-label">Football Streaming Links:</label>
          <textarea id="fbLinks" rows="4" class="form-control">https://www.yosin-tv.net/
https://www.yosintv.link/football.html</textarea>
        </div>
        <div class="col-md-6">
          <label class="form-label">Cricket Streaming Links:</label>
          <textarea id="crLinks" rows="4" class="form-control">https://www.yosin-tv.net/
https://www.yosintv.link/</textarea>
        </div>
        <div class="col-12">
          <label class="form-label">Highlights Link:</label>
          <input type="text" id="hlLink" class="form-control" value="https://www.cricfoot.net/">
        </div>
      </div>
    </details>

    <button onclick="generateTxt()" class="btn btn-success btn-lg w-100 shadow-sm mb-5">üöÄ Generate Match Text</button>

    <!-- Generated Telegram Text -->
    <div id="output">
      <h3 class="fw-bold text-dark mb-4">Generated Text (Double-click to copy):</h3>
      <div id="outputText"></div>
    </div>

    <!-- Today's Match Preview -->
    <div id="previewSection" class="mt-5">
      <h3 class="fw-bold text-dark mb-4">Today's Match Preview (Click to copy):</h3>
      <div id="previewText" class="preview-box"></div>
    </div>
  </div>

  <script>
    // Load saved settings on page load
    window.onload = () => {
      const savedSport = localStorage.getItem('sportMode');
      if (savedSport) {
        document.getElementById(savedSport).checked = true;
      } else {
        document.getElementById('football').checked = true;
      }

      const savedDate = localStorage.getItem('customDate');
      if (savedDate) document.getElementById('customDate').value = savedDate;

      const savedMatchups = localStorage.getItem('matchups');
      if (savedMatchups) document.getElementById('matchups').value = savedMatchups;

      ['fbLinks', 'crLinks', 'hlLink'].forEach(id => {
        const saved = localStorage.getItem(id);
        if (saved) document.getElementById(id).value = saved;
      });
    };

    function generateTxt() {
      const mode = document.querySelector('input[name="sport"]:checked').value;
      const customDate = document.getElementById('customDate').value.trim();
      const input = document.getElementById('matchups').value.trim();
      const outputText = document.getElementById('outputText');
      const previewText = document.getElementById('previewText');
      outputText.innerHTML = '';
      previewText.innerHTML = '';

      // Save current settings
      localStorage.setItem('sportMode', mode);
      localStorage.setItem('customDate', customDate);
      localStorage.setItem('matchups', input);
      ['fbLinks', 'crLinks', 'hlLink'].forEach(id => {
        localStorage.setItem(id, document.getElementById(id).value.trim());
      });

      if (!input) {
        outputText.innerHTML = '<p class="text-danger fw-bold">Please enter at least one matchup!</p>';
        previewText.innerHTML = '<p class="text-muted">No matches entered yet.</p>';
        return;
      }

      const lines = input.split('\n').map(l => l.trim()).filter(l => l);
      const unique = new Set();
      const previewMatches = [];
      let output = '';

      const matchRegex = /^(.*?)\s+vs\s+(.*?)(?:\s*\|\s*(.+))?$/i;

      // Auto date fallback
      const today = new Date();
      const autoDate = today.toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' });
      const displayDate = customDate || autoDate;

      // Header
      const sportName = mode === 'cricket' ? 'Cricket' : mode === 'football' ? 'Football' : 'Football & Cricket';
      output += `‚ö†Ô∏è Today's ${sportName} Matches | Live ‚ÄºÔ∏è\n`;
      output += `üìÖ Date: ${displayDate}\n\n`;

      // Load links
      const fbLinks = document.getElementById('fbLinks').value.trim().split('\n').map(l => l.trim()).filter(l => l);
      const crLinks = document.getElementById('crLinks').value.trim().split('\n').map(l => l.trim()).filter(l => l);

      const matchEmoji = mode === 'cricket' ? 'üèè' : '‚öΩ';

      let activeLinks = [];
      if (mode === 'football') activeLinks = fbLinks;
      else if (mode === 'cricket') activeLinks = crLinks;
      else activeLinks = [...new Set([...fbLinks, ...crLinks])];

      // Process every 3 lines
      for (let i = 0; i < lines.length; i += 3) {
        if (i + 1 >= lines.length) break;

        const matchupLine = lines[i + 1];
        const match = matchupLine.match(matchRegex);
        if (!match) continue;

        let team1 = match[1].trim();
        let team2 = match[2].trim();
        const competition = match[3] ? match[3].trim() : null;

        const key = `${team1} vs ${team2}`;
        if (unique.has(key)) continue;
        unique.add(key);

        // Add to preview with trailing comma
        previewMatches.push(`${team1} vs ${team2},`);

        // Add competition trophy if exists
        if (competition) {
          output += `üèÜ ${competition}\n`;
        }

        output += `${matchEmoji} ${team1} üÜö ${team2}\n`;

        activeLinks.forEach(link => {
          output += `üëâ ${link}\n`;
        });
        output += '\n';
      }

      // Final Telegram output
      if (unique.size === 0) {
        output = '<p class="text-danger fw-bold">No valid matchups detected.</p>';
      } else {
        const hl = document.getElementById('hlLink').value.trim() || 'https://www.cricfoot.net/';
        const hlText = mode === 'both' ? 'Football/Cricket' : sportName;
        output += `üì± Watch ${hlText} Highlights ‚¨áÔ∏è\nüëâ ${hl}`;
      }

      // Display Telegram text
      const pre = document.createElement('pre');
      pre.textContent = output.trim();
      pre.ondblclick = () => {
        navigator.clipboard.writeText(output.trim()).then(() => {
          const msg = document.createElement('div');
          msg.className = 'copy-message';
          msg.textContent = '‚úÖ Copied to clipboard!';
          outputText.appendChild(msg);
          setTimeout(() => msg.remove(), 3000);
        });
      };
      outputText.appendChild(pre);

      // Display Match Preview (one per line with comma)
      if (previewMatches.length > 0) {
        const previewContent = previewMatches.join('\n');
        previewText.textContent = previewContent;

        previewText.onclick = () => {
          navigator.clipboard.writeText(previewContent).then(() => {
            const msg = document.createElement('div');
            msg.className = 'copy-message';
            msg.textContent = '‚úÖ Preview copied!';
            previewText.appendChild(msg);
            setTimeout(() => msg.remove(), 3000);
          });
        };
      } else {
        previewText.innerHTML = '<p class="text-muted">No matches to preview.</p>';
      }
    }
  </script>
</body>
</html>
